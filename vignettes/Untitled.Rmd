---
title: "emtdata"
author: "Malvika D. Kharbanda"
date: "`r BiocStyle::doc_date()`"
output:
  prettydoc::html_pretty:
    theme: hpstr
    toc: yes
    toc_depth: 2
    number_sections: yes
    fig_caption: yes
    df_print: paged
vignette: >
  %\VignetteIndexEntry{emtdata}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# emtdata

This package can be installed using the code below:

```{r install}
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("emtdata")
```

# Download data from the emtdata R package

Data in this package can be downloaded using the `ExperimentHub` interface as shown below. To download the data, we first need to get a list of the data available in the `emtdata` package and determine the unique identifiers for each data. The `query()` function assists in getting this list.

```{r load-packages, message=FALSE}
library(emtdata)
library(ExperimentHub)
```

```{r get-emtdata}
eh = ExperimentHub()
query(eh , 'emtdata')
```

Data can then be downloaded using the unique identifier.

```{r download-emtdata-cursons2018-id}
eh[['EH5440']]
```

Alternatively, data can be downloaded using object name accessors in the `emtdata` package as below:

```{r download-emtdata-cursons2018-accessor}
#metadata are displayed
cursons2018_se(metadata = TRUE)
#data are loaded
cursons2018_se()
```

# Accessing SummarizedExperiment object

```{r access-se}
cursons2018_se = eh[['EH5440']]

#read counts
assay(cursons2018_se)[1:5, 1:5]

#genes
rowData(cursons2018_se)

#sample information
colData(cursons2018_se)
```

# Exploratory analysis and visualization 

```{r}
library(edgeR)
cursons2018_dge <- asDGEList(cursons2018_se)
cursons2018_dge <- calcNormFactors(cursons2018_dge)
plotMDS(cursons2018_dge, labels = colnames(cursons2018_dge))
#legend("topright", legend=levels(cursons2018_group), pch=pch, col=colors, ncol=2)

```
```{r}
dge = asDGEList(cursons2018_se)

plotMDS(dge, labels = colnames(dge))
```

# Session information

```{r sessionInfo}
sessionInfo()
```
